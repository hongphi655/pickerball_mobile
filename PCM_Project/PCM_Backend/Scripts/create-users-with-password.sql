SET QUOTED_IDENTIFIER ON;
SET ANSI_NULLS ON;

-- Password123! hash generated by ASP.NET Core Identity
-- Using: new PasswordHasher<IdentityUser>().HashPassword(new IdentityUser(), "Password123!")
DECLARE @PasswordHash NVARCHAR(MAX) = N'AQAAAAIAAYagAAAAEOkGj3s1w7jVdTFPJtHKFZPKO0v3qmZJZX0q0YHZ0qEBJk0uNgINdKTKYVQp3oEW7Q==';

-- Delete old sample users first
DELETE FROM AspNetUserRoles WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE UserName IN ('admin', 'john_doe', 'jane_smith', 'mike_wilson', 'sarah_jones', 'tom_brown'));
DELETE FROM AspNetUsers WHERE UserName IN ('admin', 'john_doe', 'jane_smith', 'mike_wilson', 'sarah_jones', 'tom_brown');

-- Delete corresponding members
DELETE FROM [001_Members] WHERE UserId IN (SELECT Id FROM AspNetUsers WHERE UserName IN ('admin', 'john_doe', 'jane_smith', 'mike_wilson', 'sarah_jones', 'tom_brown'));

-- Get role IDs
DECLARE @AdminRoleId NVARCHAR(128) = (SELECT Id FROM AspNetRoles WHERE Name = 'Admin');
DECLARE @UserRoleId NVARCHAR(128) = (SELECT Id FROM AspNetRoles WHERE Name = 'User');

-- Create new users with correct password hash
DECLARE @AdminId NVARCHAR(128) = NEWID();
DECLARE @UserId1 NVARCHAR(128) = NEWID();
DECLARE @UserId2 NVARCHAR(128) = NEWID();
DECLARE @UserId3 NVARCHAR(128) = NEWID();
DECLARE @UserId4 NVARCHAR(128) = NEWID();
DECLARE @UserId5 NVARCHAR(128) = NEWID();

-- Insert users
INSERT INTO AspNetUsers (Id, UserName, NormalizedUserName, Email, NormalizedEmail, EmailConfirmed, PasswordHash, SecurityStamp, ConcurrencyStamp, PhoneNumber, PhoneNumberConfirmed, TwoFactorEnabled, LockoutEnd, LockoutEnabled, AccessFailedCount)
VALUES 
(@AdminId, N'admin', N'ADMIN', N'admin@pcm.com', N'ADMIN@PCM.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0),
(@UserId1, N'john_doe', N'JOHN_DOE', N'john@example.com', N'JOHN@EXAMPLE.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0),
(@UserId2, N'jane_smith', N'JANE_SMITH', N'jane@example.com', N'JANE@EXAMPLE.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0),
(@UserId3, N'mike_wilson', N'MIKE_WILSON', N'mike@example.com', N'MIKE@EXAMPLE.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0),
(@UserId4, N'sarah_jones', N'SARAH_JONES', N'sarah@example.com', N'SARAH@EXAMPLE.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0),
(@UserId5, N'tom_brown', N'TOM_BROWN', N'tom@example.com', N'TOM@EXAMPLE.COM', 1, @PasswordHash, NEWID(), NEWID(), NULL, 0, 0, NULL, 1, 0);

-- Insert user roles
INSERT INTO AspNetUserRoles (UserId, RoleId)
VALUES 
(@AdminId, @AdminRoleId),
(@UserId1, @UserRoleId),
(@UserId2, @UserRoleId),
(@UserId3, @UserRoleId),
(@UserId4, @UserRoleId),
(@UserId5, @UserRoleId);

-- Insert members with IDENTITY_INSERT
SET IDENTITY_INSERT [001_Members] ON;
INSERT INTO [001_Members] (Id, FullName, JoinDate, RankLevel, IsActive, UserId, Tier, WalletBalance, TotalSpent, AvatarUrl)
VALUES 
(1, N'Nguyễn Văn Admin', '2025-01-01', 10.0, 1, @AdminId, N'Platinum', 5000000.0, 1000000.0, NULL),
(2, N'John Doe', '2025-01-15', 7.5, 1, @UserId1, N'Gold', 2000000.0, 500000.0, NULL),
(3, N'Jane Smith', '2025-01-10', 8.0, 1, @UserId2, N'Gold', 1500000.0, 750000.0, NULL),
(4, N'Mike Wilson', '2025-01-20', 6.0, 1, @UserId3, N'Silver', 1000000.0, 300000.0, NULL),
(5, N'Sarah Jones', '2025-01-25', 7.0, 1, @UserId4, N'Silver', 800000.0, 400000.0, NULL),
(6, N'Tom Brown', '2025-01-28', 5.5, 1, @UserId5, N'Standard', 500000.0, 200000.0, NULL);
SET IDENTITY_INSERT [001_Members] OFF;

PRINT 'Tạo users và members thành công!';
PRINT 'Password cho tất cả users: Password123!';
